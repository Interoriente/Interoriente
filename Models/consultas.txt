
==================================

1. Valor ventas anuales. LISTO
    Dos datos:
        1. Mes
        2. Vlr. Total de ventas realizadas en ese mes 


SELECT month(FA.fechaFactura) AS 'Mes', 
SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) AS 'Total'
FROM tblFactura AS FA
INNER JOIN tblFacturaPublicacion AS FP
ON FP.numFacturaPublicacion = FA.numeroFactura
INNER JOIN tblPublicacion AS PU 
ON PU.idPublicacion = FP.idPublicacionFactura
WHERE YEAR(FA.fechaFactura) = YEAR(CURDATE()) 
AND PU.docIdentidadPublicacion = 'documento'
GROUP BY month(FA.fechaFactura)
==================================

2. Cantidad de ventas de x día a y día de la semana pasada. LISTO

    Datos:
        1. Cantidad de ventas realizadas por día en los últimos 7 días
        2. De la semana anterior a la actual

SELECT DAY(FA.fechaFactura), COUNT(FA.numeroFactura)
FROM tblFactura as FA
INNER JOIN tblFacturaPublicacion as FP
ON FP.numFacturaPublicacion=FA.numeroFactura
INNER JOIN tblPublicacion AS PU 
ON PU.idPublicacion = FP.idPublicacionFactura 
WHERE FA.fechaFactura BETWEEN DATE(DATE_SUB(NOW(),INTERVAL 7 DAY))
AND NOW() AND PU.docIdentidadPublicacion='documento'
GROUP BY DAY(FA.fechaFactura)

==================================
3. Publicaciones más exitosas: 
    1. Título
    2. No. Ventas
    3. Ventas Totales
    4. Cantidad en stock
    5. Porcentaje que representa sobre el total de las ventas

$total = n;
$total              100%
$totalNProducto -> id  ?
totalNProducto*100/total 

LISTO!!!!!!!!!!!!!!!->


****
$reporte["Titulos" => null, No. "Ventas" => null, ]

SELECT MONTH(FA.fechaFactura) AS 'Mes', 
SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) AS 'Total' 
FROM tblFactura AS FA 
INNER JOIN tblFacturaPublicacion AS FP ON FP.numFacturaPublicacion = FA.numeroFactura 
INNER JOIN tblPublicacion AS PU ON PU.idPublicacion = FP.idPublicacionFactura WHERE YEAR(FA.fechaFactura) = YEAR(CURDATE()) AND docIdentidadPublicacion = p_id 
GROUP BY MONTH(FA.fechaFactura)

SELECT (SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) / Vlr_Ventas) AS 'Total'
FROM tblPublicacion as PU
INNER JOIN tblFacturaPublicacion AS FP 
ON PU.idPublicacion = FP.idPublicacionFactura
GROUP BY FP.idPublicacionFactura
ORDER BY Vlr_Ventas DESC LIMIT 5

****
SELECT PU.idPublicacion AS 'Id', PU.nombrePublicacion AS 'Titulo', 
COUNT(PU.idPublicacion) AS 'CantidadVentas', 
PU.stockPublicacion AS 'Stock', 
SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) AS "Vlr_Ventas" 
FROM tblPublicacion as PU 
INNER JOIN tblFacturaPublicacion as FP 
ON FP.idPublicacionFactura = PU.idPublicacion 
WHERE PU.docIdentidadPublicacion = 123456789 
GROUP BY PU.idPublicacion ORDER BY Vlr_Ventas DESC LIMIT 5

****
$id = [93, 133, 172, 97, 157];
$arr = [];
For{
SELECT SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) AS 'Total'
FROM tblPublicacion as PU
INNER JOIN tblFacturaPublicacion AS FP 
ON PU.idPublicacion = FP.idPublicacionFactura
WHERE PU.idPublicacion = $id[n]
GROUP BY FP.idPublicacionFactura;

$resultado = stmt->fetch(PDO::FETCH_ASOCC);
$resultado = $resultado["Total"];
array_push($arr, $resultado);
}

return $reporte;
****

*******

SELECT PU.nombrePublicacion AS 'Titulo', COUNT(PU.idPublicacion)
AS 'CantidadVentas', PU.stockPublicacion AS 'Stock', 

(SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) AS 'Total') * 100 ) / SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion);


FROM tblPublicacion as PU
INNER JOIN tblFacturaPublicacion as FP
ON FP.idPublicacionFactura = PU.idPublicacion
WHERE PU.docIdentidadPublicacion = 'documento'
ORDER BY  DESC
LIMIT 5
==================================

4. Cantidad ventas hoy. Total ventas hoy
SELECT COUNT(FP.idPublicacionFactura) 'NO_ventas',
SUM(PU.costoPublicacion * FP.cantidadFacturaPublicacion) 
AS 'Total' FROM tblFactura as FA 
INNER JOIN tblFacturaPublicacion as FP ON FP.numFacturaPublicacion= FA.numeroFactura 
INNER JOIN tblPublicacion AS PU ON PU.idPublicacion = FP.idPublicacionFactura 
WHERE FA.fechaFactura=CURDATE() 
AND PU.docIdentidadPublicacion = p_id

Tarjeta 3
==================================

5. Ventas por ciudad//...\\

SELECT CI.nombreCiudad as 'Municipio',COUNT(FA.numeroFactura)
AS 'Número Ventas'
FROM tblCiudad AS CI
INNER JOIN tblDirecciones AS DI
ON DI.ciudadDireccion=CI.idCiudad
INNER JOIN tblUsuario AS US
ON US.documentoIdentidad=DI.docIdentidadDireccion
INNER JOIN tblFactura AS FA
ON FA.docIdentidadFactura=US.documentoIdentidad
GROUP BY CI.nombreCiudad
ORDER BY SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) DESC
==================================

6. Alerta de stock (A cuántas publicaciones se les va a terminar el stock) LISTO
SELECT nombrePublicacion,stockPublicacion
FROM tblPublicacion
WHERE stockPublicacion<=5 and docIdentidadPublicacion=123456789

SELECT COUNT(nombrePublicacion) AS "No_publicaciones" 
FROM tblPublicacion 
WHERE stockPublicacion <= 5 AND docIdentidadPublicacion = p_id

Tarjeta 1
==================================
7. Total de ventas de este mes y porcentaje de último mes comparado con el actual.

SELECT SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) 
AS 'TotalMesActual' 
FROM tblFactura as FA
INNER JOIN tblFacturaPublicacion as FP
ON FP.numFacturaPublicacion = FA.numeroFactura
INNER JOIN tblPublicacion AS PU 
ON PU.idPublicacion = FP.idPublicacionFactura
WHERE MONTH(FA.fechaFactura) = MONTH(CURRENT_DATE()) AND PU.docIdentidadPublicacion = 123456789 AND YEAR(FA.fechaFactura) = YEAR(CURRENT_DATE())
GROUP BY MONTH(FA.fechaFactura) 

SELECT SUM(PU.costoPublicacion * FP.cantidadFacturaPublicacion) AS "Total" 
FROM tblFactura AS FA 
INNER JOIN tblFacturaPublicacion AS FP 
ON FP.numFacturaPublicacion = FA.numeroFactura 
INNER JOIN tblPublicacion AS PU ON PU.idPublicacion = FP.idPublicacionFactura 
WHERE MONTH(FA.fechaFactura) = MONTH(DATE_ADD(CURDATE(),INTERVAL -1 MONTH)) AND YEAR(FA.fechaFactura) = YEAR(CURRENT_DATE) AND PU.docIdentidadPublicacion = 123456789


SELECT SUM(FP.cantidadFacturaPublicacion * PU.costoPublicacion) 
AS 'TotalMesActual' 
FROM tblFactura as FA
INNER JOIN tblFacturaPublicacion as FP
ON FP.numFacturaPublicacion = FA.numeroFactura
INNER JOIN tblPublicacion AS PU 
ON PU.idPublicacion = FP.idPublicacionFactura
WHERE FA.fechaFactura = MOTH(NOW()))
AND NOW()
GROUP BY MONTH(FA.fechaFactura) 

MONTH(DATE_SUB(NOW(), INTERVAL 1 MONTH)
Tarjeta de Performance
==================================
8. Número de publicaciones sin validar
SELECT nombrePublicacion
FROM tblPublicacion
WHERE validacionPublicacion=0 AND docIdentidadPublicacion='123456789'

Tarjeta 2
==================================


Reporte

SELECT



